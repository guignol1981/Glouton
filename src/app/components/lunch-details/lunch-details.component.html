<div *ngIf="lunch" class="container mt-3">
    <div class="row">
        <div class="col-8">
            <h2 class="font-weight-bold">{{lunch.title}}</h2>
        </div>
        <div class="col text-right">
            <span *ngIf="lunch.isPending()" class="badge badge-secondary">pending</span>
            <span *ngIf="lunch.asJoined(user)" class="badge badge-info">joined</span>
            <span *ngIf="lunch.isFull()" class="badge badge-info">full</span>
            <span *ngIf="lunch.isConfirmed()" class="badge badge-success">confirmed</span>
            <span *ngIf="lunch.isCanceled()" class="badge badge-danger">canceled</span>
        </div>
    </div>
    <div class="row mt-3">
        <div class="col-xl-3 col-lg-4 col-md-6 col-sm-6 col-12">
            <div class="card global-shadow">
                <img style="height: auto; width: 100%;"
                     [src]="imageService.apiEndPoint + '/' + lunch._id"
                     alt="lunch img">
            </div>
            <div class="mt-2">
                <h4>
                    {{lunch.description}}
                </h4>
            </div>
        </div>
        <div class="card col global-shadow">
            <ul class="list-group">
                <li *ngIf="lunch.isPending()" class="list-group-item border-0">
                    <div class="mt-3">
                        <button *ngIf="lunch.canJoin(user)" (click)="joinLunch()" class="btn btn-sm btn-primary ">Join
                        </button>
                        <button *ngIf="lunch.canLeave(user)" (click)="leaveLunch()"
                                class="btn btn-warning btn-sm ">Leave
                        </button>
                        <app-private-message [author]="user" [recipient]="lunch.cook"></app-private-message>
                        <span *ngIf="lunch.isCook(user)">
                                <button (click)="editLunch()"
                                        class="btn btn-secondary btn-sm ">edit</button>
                                <button (click)="cancelLunch(lunchformeditbutton)"
                                        class="btn btn-danger btn-sm ">cancel</button>
                        </span>
                    </div>
                    <hr>
                </li>
                <li class="list-group-item border-0">
                    <span class="font-weight-bold">
                    {{lunch.contribution | currency:'USD':true:'1.2-2'}}
                    </span>
                    <hr>
                </li>
                <li class="list-group-item border-0">
                    <span class="font-weight-bold">
                    Type -
                    </span>
                    {{lunchType[lunch.type]}}
                    <hr>
                </li>
                <li class="list-group-item border-0">
                     <span class="font-weight-bold">
                         Served on
                     </span>
                    {{weekDayName}} the {{lunch.deliveryDate | date}} at {{lunch.deliveryHour}}h
                    <hr *ngIf="lunch.isCook(user)">
                </li>
                <li *ngIf="lunch.isPending()" class="list-group-item border-0">
                    <span class="font-weight-bold">
                        {{lunch.isCook(user)? 'Participants' : 'You'}} still have {{remaningTime}} to {{lunch.asJoined(user)? 'leave': 'join'}}
                    </span>
                    <hr>
                </li>
                <li class="list-group-item border-0">
                        <span class="font-weight-bold">
                            Cooked by:
                        </span>
                    {{lunch.cook.name | titlecase}}
                    <!--<span *ngIf="! lunch.isCook(user)">-->
                    <!--<button class="btn btn-secondary btn-sm" data-toggle="modal"-->
                    <!--[attr.data-target]="'#messageModal'">-->
                    <!--write to the cook-->
                    <!--</button>-->
                    <!--</span>-->
                </li>
                <li class="list-group-item border-0">
                     <span class="font-weight-bold">
                         Participant(s):
                     </span>
                    {{lunch.participants.length}} (min: {{lunch.minParticipants}}, max: {{lunch.maxParticipants}})
                    <ul class="list-group">
                        <li *ngFor="let participant of lunch.participants" class="list-group-item border-0 py-0">
                            {{participant.name}}
                        </li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</div>